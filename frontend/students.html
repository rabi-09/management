<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Management</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>ðŸŽ“ Student Management</h2>
  <a href="index.html">â¬… Back to Home</a>

  <div id="form-container">
    <h3 id="form-title">Add Student</h3>
    <input type="text" id="name" placeholder="Name">
    <input type="number" id="age" placeholder="Age">
    <input type="text" id="course" placeholder="Course">
    <button onclick="addOrUpdateStudent()">Save</button>
  </div>

  <table border="1" id="student-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Age</th>
        <th>Course</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script src="script.js"></script>
  <script>
    const API_BASE = "https://student-2miz.onrender.com/students";
    let editId = null;

    async function loadStudents() {
      const res = await fetch(API_BASE);
      const data = await res.json();
      const tbody = document.querySelector("#student-table tbody");
      tbody.innerHTML = "";

      data.forEach(s => {
        const row = `
          <tr>
            <td>${s.name}</td>
            <td>${s.age}</td>
            <td>${s.course}</td>
            <td>
              <button onclick="editStudent('${s._id}', '${s.name}', ${s.age}, '${s.course}')">Edit</button>
              <button onclick="deleteStudent('${s._id}')">Delete</button>
            </td>
          </tr>`;
        tbody.innerHTML += row;
      });
    }

    async function addOrUpdateStudent() {
      const name = document.getElementById("name").value;
      const age = document.getElementById("age").value;
      const course = document.getElementById("course").value;

      const data = { name, age, course };
      if (editId) {
        await fetch(`${API_BASE}/${editId}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
        editId = null;
        document.getElementById("form-title").innerText = "Add Student";
      } else {
        await fetch(API_BASE, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
      }

      document.getElementById("name").value = "";
      document.getElementById("age").value = "";
      document.getElementById("course").value = "";
      loadStudents();
    }

    function editStudent(id, name, age, course) {
      editId = id;
      document.getElementById("name").value = name;
      document.getElementById("age").value = age;
      document.getElementById("course").value = course;
      document.getElementById("form-title").innerText = "Edit Student";
    }

    async function deleteStudent(id) {
      await fetch(`${API_BASE}/${id}`, { method: "DELETE" });
      loadStudents();
    }

    loadStudents();
  </script>
</body>
</html>
